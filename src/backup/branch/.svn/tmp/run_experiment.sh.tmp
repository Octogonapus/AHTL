#!/bin/sh
datadir="/data"

for bin in "histogram_sse" "histogram_avx"; do
for opt in 3 4 5 6; do
for thr in 32; do
output1="${datadir}/log/flat_${bin}_${opt}_${thr}.log"
output2="${datadir}/log/zipf1_${bin}_${opt}_${thr}.log"
output3="${datadir}/log/zipf2_${bin}_${opt}_${thr}.log"
#rm $output1
#rm $output2
#rm $output3
done
done
done


size=8192
while [ $size -le 16384 ]
do
input1="${datadir}/uniform/flat_${size}_128M.raw"
input2="${datadir}/zipf/zipf_${size}_1.0.raw"
input3="${datadir}/zipf/zipf_${size}_2.0.raw"
for bin in  "histogram_sse" ; do
for opt in 3 4 5; do
for thr in 32; do
output1="${datadir}/log/flat_${bin}_${opt}_${thr}.log"
output2="${datadir}/log/zipf1_${bin}_${opt}_${thr}.log"
output3="${datadir}/log/zipf2_${bin}_${opt}_${thr}.log"
echo "size=${size} .."
echo ${input1}
echo ${input2}
echo ${input3}
echo "size= ${size} .." >> $output1
echo "size= ${size} .." >> $output2
echo "size= ${size} .." >> $output3
./$bin -f ${input1} -N ${size} -b 0 -w 1 -t ${thr} -i 1  -H ${opt} -c 1 >> ${output1}
./$bin -f ${input2} -N ${size} -b 0 -w 1 -t ${thr} -i 1  -H ${opt} -c 1 >> ${output2}
./$bin -f ${input3} -N ${size} -b 0 -w 1 -t ${thr} -i 1  -H ${opt} -c 1 >> ${output3}
done
done
done
size=`expr $size + $size`
done

